<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mockæ•°æ®æ¼”ç¤º - æ—…æ¸¸åŠ©æ‰‹</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .demo-section {
            background: white;
            margin: 20px 0;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .demo-section h2 {
            color: #007acc;
            border-bottom: 2px solid #007acc;
            padding-bottom: 10px;
        }
        .demo-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin: 15px 0;
        }
        .demo-btn {
            background: #007acc;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            transition: background 0.3s;
        }
        .demo-btn:hover {
            background: #005c99;
        }
        .demo-btn.secondary {
            background: #6c757d;
        }
        .demo-btn.secondary:hover {
            background: #545b62;
        }
        .demo-output {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            padding: 15px;
            border-radius: 5px;
            font-family: monospace;
            white-space: pre-wrap;
            max-height: 300px;
            overflow-y: auto;
        }
        .highlight {
            background: #fff3cd;
            padding: 15px;
            border-left: 4px solid #ffc107;
            margin: 15px 0;
        }
        .api-example {
            background: #d1ecf1;
            padding: 15px;
            border-left: 4px solid #007acc;
            margin: 15px 0;
        }
        code {
            background: #f8f9fa;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: monospace;
        }
    </style>
</head>
<body>
    <h1>ğŸš— è½¦æœºæ—…æ¸¸åŠ©æ‰‹ - Mockæ•°æ®æ¼”ç¤º</h1>

    <div class="highlight">
        <h3>ğŸ“ åŠŸèƒ½è¯´æ˜</h3>
        <p>æ­¤æ¼”ç¤ºé¡µé¢å±•ç¤ºå¦‚ä½•é€šè¿‡ä¿®æ”¹mockæ•°æ®å˜é‡æ¥åŠ¨æ€æ›´æ–°é¡µé¢å†…å®¹ï¼Œä¸ºåç«¯æ¥å…¥åšå‡†å¤‡ã€‚</p>
        <p><strong>é‡è¦ï¼š</strong>åœ¨å®é™…é¡¹ç›®ä¸­ï¼Œè¿™äº›mockæ•°æ®ä¼šè¢«æ›¿æ¢ä¸ºçœŸå®çš„APIæ¥å£è°ƒç”¨ã€‚</p>
    </div>

    <div class="demo-section">
        <h2>ğŸ”§ åŸºç¡€é…ç½®ç®¡ç†</h2>
        <p>ä¿®æ”¹åº”ç”¨çš„åŸºç¡€é…ç½®ä¿¡æ¯ï¼Œå¦‚æ ‡é¢˜ã€ä½ç½®ç­‰ã€‚</p>

        <div class="demo-buttons">
            <button class="demo-btn" onclick="updateTitle()">æ›´æ–°åº”ç”¨æ ‡é¢˜</button>
            <button class="demo-btn" onclick="updateLocation()">æ›´æ”¹ä½ç½®</button>
            <button class="demo-btn" onclick="resetConfig()">é‡ç½®é…ç½®</button>
        </div>

        <div class="api-example">
            <strong>APIç¤ºä¾‹ï¼š</strong><br>
            <code>TravelAPI.updateConfig({title: 'åŒ—äº¬äº”æ—¥æ¸¸', location: 'åŒ—äº¬å¸‚'})</code>
        </div>

        <div class="demo-output" id="config-output"></div>
    </div>

    <div class="demo-section">
        <h2>ğŸ“ è·¯çº¿ç‚¹ç®¡ç†</h2>
        <p>åŠ¨æ€æ·»åŠ ã€åˆ é™¤å’Œä¿®æ”¹åœ°å›¾ä¸Šçš„è·¯çº¿ç‚¹ã€‚</p>

        <div class="demo-buttons">
            <button class="demo-btn" onclick="addRandomPoint()">æ·»åŠ éšæœºæ™¯ç‚¹</button>
            <button class="demo-btn" onclick="addHotelPoint()">æ·»åŠ é…’åº—</button>
            <button class="demo-btn" onclick="removeLastPoint()">åˆ é™¤æœ€åä¸€ä¸ªç‚¹</button>
            <button class="demo-btn secondary" onclick="showRoutePoints()">æŸ¥çœ‹æ‰€æœ‰è·¯çº¿ç‚¹</button>
        </div>

        <div class="api-example">
            <strong>APIç¤ºä¾‹ï¼š</strong><br>
            <code>TravelAPI.addRoutePoint({x: 300, y: 200, name: 'æ•…å®«', type: 'attraction'})</code>
        </div>

        <div class="demo-output" id="route-output"></div>
    </div>

    <div class="demo-section">
        <h2>ğŸƒ ä¿¡æ¯å¡ç‰‡ç®¡ç†</h2>
        <p>æ›´æ–°ä¾§è¾¹æ çš„ä¿¡æ¯å¡ç‰‡å†…å®¹ï¼ŒåŒ…æ‹¬å¤©æ°”ã€é…’åº—ã€æ™¯ç‚¹ä¿¡æ¯ç­‰ã€‚</p>

        <div class="demo-buttons">
            <button class="demo-btn" onclick="updateWeather()">æ›´æ–°å¤©æ°”ä¿¡æ¯</button>
            <button class="demo-btn" onclick="updateHotelStatus()">æ›´æ–°é…’åº—çŠ¶æ€</button>
            <button class="demo-btn" onclick="addNewCard()">æ·»åŠ æ–°å¡ç‰‡</button>
            <button class="demo-btn secondary" onclick="showCardsData()">æŸ¥çœ‹æ‰€æœ‰å¡ç‰‡</button>
        </div>

        <div class="api-example">
            <strong>APIç¤ºä¾‹ï¼š</strong><br>
            <code>TravelAPI.updateCards([...newCardsArray])</code>
        </div>

        <div class="demo-output" id="cards-output"></div>
    </div>

    <div class="demo-section">
        <h2>ğŸ“… è¡Œç¨‹å®‰æ’ç®¡ç†</h2>
        <p>ä¿®æ”¹7å¤©è¡Œç¨‹çš„è¯¦ç»†å®‰æ’ï¼ŒåŒ…æ‹¬æ—¶é—´ã€åœ°ç‚¹ã€ä»·æ ¼ç­‰ä¿¡æ¯ã€‚</p>

        <div class="demo-buttons">
            <button class="demo-btn" onclick="updateDay1()">ä¿®æ”¹ç¬¬ä¸€å¤©è¡Œç¨‹</button>
            <button class="demo-btn" onclick="addNewDay()">æ·»åŠ ç¬¬8å¤©</button>
            <button class="demo-btn" onclick="updatePrices()">æ‰¹é‡æ›´æ–°ä»·æ ¼</button>
            <button class="demo-btn secondary" onclick="showItinerary()">æŸ¥çœ‹å®Œæ•´è¡Œç¨‹</button>
        </div>

        <div class="api-example">
            <strong>APIç¤ºä¾‹ï¼š</strong><br>
            <code>TravelAPI.updateItinerary([...newItineraryArray])</code>
        </div>

        <div class="demo-output" id="itinerary-output"></div>
    </div>

    <div class="demo-section">
        <h2>ğŸ”„ å®æ—¶æ•°æ®ç›‘å¬</h2>
        <p>æ¼”ç¤ºæ•°æ®æ›´æ–°çš„äº‹ä»¶ç›‘å¬æœºåˆ¶ï¼Œå®ç°é¡µé¢å†…å®¹çš„è‡ªåŠ¨åŒæ­¥ã€‚</p>

        <div class="demo-buttons">
            <button class="demo-btn" onclick="simulateAPICall()">æ¨¡æ‹ŸAPIè°ƒç”¨</button>
            <button class="demo-btn" onclick="batchUpdate()">æ‰¹é‡æ›´æ–°æ•°æ®</button>
            <button class="demo-btn secondary" onclick="showEventLog()">æŸ¥çœ‹äº‹ä»¶æ—¥å¿—</button>
        </div>

        <div class="api-example">
            <strong>äº‹ä»¶ç›‘å¬ç¤ºä¾‹ï¼š</strong><br>
            <code>DataEvents.on('configUpdated', (newConfig) => { /* å¤„ç†é…ç½®æ›´æ–° */ })</code>
        </div>

        <div class="demo-output" id="events-output"></div>
    </div>

    <div class="highlight">
        <h3>ğŸ”— é›†æˆæŒ‡å—</h3>
        <p><strong>1. åç«¯æ¥å…¥ï¼š</strong>å°† <code>TravelAPI</code> ä¸­çš„æ–¹æ³•æ›¿æ¢ä¸ºçœŸå®çš„HTTPè¯·æ±‚</p>
        <p><strong>2. æ•°æ®æ ¼å¼ï¼š</strong>ç¡®ä¿åç«¯è¿”å›çš„æ•°æ®æ ¼å¼ä¸mockæ•°æ®ç»“æ„ä¸€è‡´</p>
        <p><strong>3. äº‹ä»¶ç³»ç»Ÿï¼š</strong>ä¿æŒ <code>DataEvents</code> äº‹ä»¶ç³»ç»Ÿï¼Œç”¨äºæ•°æ®æ›´æ–°é€šçŸ¥</p>
        <p><strong>4. é”™è¯¯å¤„ç†ï¼š</strong>åœ¨APIè°ƒç”¨ä¸­æ·»åŠ é€‚å½“çš„é”™è¯¯å¤„ç†å’Œç”¨æˆ·åé¦ˆ</p>
    </div>

    <!-- å¼•å…¥Mockæ•°æ® -->
    <script src="mockData.js"></script>
    <script>
        // æ¼”ç¤ºå‡½æ•°
        function updateTitle() {
            const newTitle = 'åŒ—äº¬æ•…å®«æ·±åº¦æ¸¸';
            TravelAPI.updateConfig({title: newTitle});
            document.getElementById('config-output').textContent = `åº”ç”¨æ ‡é¢˜å·²æ›´æ–°ä¸º: ${newTitle}`;
        }

        function updateLocation() {
            const newLocation = 'åŒ—äº¬å¸‚ä¸œåŸåŒº';
            TravelAPI.updateConfig({location: newLocation});
            document.getElementById('config-output').textContent = `ä½ç½®å·²æ›´æ–°ä¸º: ${newLocation}`;
        }

        function resetConfig() {
            TravelAPI.updateConfig({
                title: 'ä¸Šæµ·ä¸ƒæ—¥æ¸¸',
                location: 'ä¸Šæµ·å¸‚',
                totalDays: 7
            });
            document.getElementById('config-output').textContent = 'é…ç½®å·²é‡ç½®ä¸ºé»˜è®¤å€¼';
        }

        function addRandomPoint() {
            const attractions = ['å¤©å®‰é—¨å¹¿åœº', 'æ•…å®«åšç‰©é™¢', 'å¤©å›å…¬å›­', 'é¢å’Œå›­', 'é•¿åŸ'];
            const randomName = attractions[Math.floor(Math.random() * attractions.length)];
            const newPoint = {
                x: Math.random() * 600 + 100,
                y: Math.random() * 400 + 100,
                name: randomName,
                type: 'attraction'
            };
            TravelAPI.addRoutePoint(newPoint);
            document.getElementById('route-output').textContent = `å·²æ·»åŠ æ™¯ç‚¹: ${randomName}`;
        }

        function addHotelPoint() {
            const hotels = ['åŒ—äº¬é¥­åº—', 'ç‹åºœäº•å¤§é¥­åº—', 'å‰é—¨å»ºå›½é¥­åº—'];
            const randomHotel = hotels[Math.floor(Math.random() * hotels.length)];
            const newPoint = {
                x: Math.random() * 600 + 100,
                y: Math.random() * 400 + 100,
                name: randomHotel,
                type: 'hotel'
            };
            TravelAPI.addRoutePoint(newPoint);
            document.getElementById('route-output').textContent = `å·²æ·»åŠ é…’åº—: ${randomHotel}`;
        }

        function removeLastPoint() {
            const points = window.RoutePointsData;
            if (points.length > 0) {
                const lastPoint = points[points.length - 1];
                TravelAPI.removeRoutePoint(lastPoint.id);
                document.getElementById('route-output').textContent = `å·²åˆ é™¤: ${lastPoint.name}`;
            } else {
                document.getElementById('route-output').textContent = 'æ²¡æœ‰å¯åˆ é™¤çš„è·¯çº¿ç‚¹';
            }
        }

        function showRoutePoints() {
            const points = window.RoutePointsData;
            const output = points.map(p => `${p.name} (${p.type}) - åæ ‡(${p.x}, ${p.y})`).join('\n');
            document.getElementById('route-output').textContent = `å½“å‰è·¯çº¿ç‚¹ (${points.length}ä¸ª):\n${output}`;
        }

        function updateWeather() {
            const cards = [...window.CardsData];
            const weatherCard = cards.find(c => c.id === 'weather-general');
            if (weatherCard) {
                weatherCard.value = Math.floor(Math.random() * 15 + 15) + 'Â°C';
                weatherCard.content = 'åŒ—äº¬å¸‚å¤šäº‘ï¼Œå¾®é£ï¼Œé€‚åˆå‡ºè¡Œ';
                weatherCard.time = new Date().toLocaleTimeString('zh-CN', {hour: '2-digit', minute: '2-digit'});
                TravelAPI.updateCards(cards);
                document.getElementById('cards-output').textContent = `å¤©æ°”å·²æ›´æ–°: ${weatherCard.value}`;
            }
        }

        function updateHotelStatus() {
            const cards = [...window.CardsData];
            const hotelCards = cards.filter(c => c.type === 'hotel');
            hotelCards.forEach(card => {
                const statuses = ['available', 'busy'];
                const statusTexts = ['æœ‰æˆ¿', 'ç´§å¼ '];
                const randomIndex = Math.floor(Math.random() * statuses.length);
                card.status = statuses[randomIndex];
                card.statusText = statusTexts[randomIndex];
            });
            TravelAPI.updateCards(cards);
            document.getElementById('cards-output').textContent = `å·²æ›´æ–° ${hotelCards.length} ä¸ªé…’åº—çš„çŠ¶æ€`;
        }

        function addNewCard() {
            const cards = [...window.CardsData];
            const newCard = {
                id: 'demo-card-' + Date.now(),
                type: 'attraction',
                title: 'æ¼”ç¤ºæ™¯ç‚¹',
                content: 'è¿™æ˜¯ä¸€ä¸ªæ¼”ç¤ºæ·»åŠ çš„æ–°æ™¯ç‚¹å¡ç‰‡',
                value: 'Â¥50',
                status: 'available',
                statusText: 'å¼€æ”¾ä¸­',
                icon: 'ğŸ¯',
                pointTypes: ['all'],
                pointId: null,
                time: new Date().toLocaleTimeString('zh-CN', {hour: '2-digit', minute: '2-digit'})
            };
            cards.push(newCard);
            TravelAPI.updateCards(cards);
            document.getElementById('cards-output').textContent = `å·²æ·»åŠ æ–°å¡ç‰‡: ${newCard.title}`;
        }

        function showCardsData() {
            const cards = window.CardsData;
            const output = cards.map(c => `${c.title} (${c.type}) - ${c.value}`).join('\n');
            document.getElementById('cards-output').textContent = `æ‰€æœ‰å¡ç‰‡ (${cards.length}ä¸ª):\n${output}`;
        }

        function updateDay1() {
            const itinerary = [...window.ItineraryData];
            if (itinerary[0]) {
                itinerary[0].title = 'ç¬¬ä¸€å¤© - æ•…å®«å¤©å®‰é—¨æ–‡åŒ–ä¹‹æ—…';
                itinerary[0].summary = '2ä¸ªæ™¯ç‚¹ Â· 2ä¸ªç”¨é¤ Â· 1æ™šä½å®¿';
                itinerary[0].items[0].title = 'å¤©å®‰é—¨å¹¿åœº';
                itinerary[0].items[0].description = 'ä¸­åäººæ°‘å…±å’Œå›½çš„è±¡å¾ï¼Œè§‚çœ‹å‡æ——ä»ªå¼';
                TravelAPI.updateItinerary(itinerary);
                document.getElementById('itinerary-output').textContent = 'ç¬¬ä¸€å¤©è¡Œç¨‹å·²æ›´æ–°ä¸ºåŒ—äº¬ä¸»é¢˜';
            }
        }

        function addNewDay() {
            const itinerary = [...window.ItineraryData];
            const newDay = {
                day: 8,
                date: '2024-01-22',
                title: 'ç¬¬å…«å¤© - é¢å¤–å»¶ä¼¸æ¸¸',
                summary: '1ä¸ªæ™¯ç‚¹ Â· 1ä¸ªç”¨é¤',
                items: [
                    {
                        time: '10:00',
                        type: 'attraction',
                        title: 'åœ†æ˜å›­',
                        description: 'å†å²é—è¿¹ï¼Œæ„Ÿå—å†å²æ²§æ¡‘',
                        price: 'Â¥25',
                        duration: '3å°æ—¶',
                        icon: 'ğŸ›ï¸'
                    }
                ]
            };
            itinerary.push(newDay);
            TravelAPI.updateItinerary(itinerary);
            document.getElementById('itinerary-output').textContent = 'å·²æ·»åŠ ç¬¬8å¤©è¡Œç¨‹';
        }

        function updatePrices() {
            const itinerary = [...window.ItineraryData];
            let updateCount = 0;
            itinerary.forEach(day => {
                day.items.forEach(item => {
                    if (item.price && item.price.includes('Â¥')) {
                        const currentPrice = parseInt(item.price.replace('Â¥', ''));
                        const newPrice = Math.floor(currentPrice * (0.8 + Math.random() * 0.4)); // Â±20%å˜åŠ¨
                        item.price = 'Â¥' + newPrice;
                        updateCount++;
                    }
                });
            });
            TravelAPI.updateItinerary(itinerary);
            document.getElementById('itinerary-output').textContent = `å·²æ›´æ–° ${updateCount} ä¸ªé¡¹ç›®çš„ä»·æ ¼`;
        }

        function showItinerary() {
            const itinerary = window.ItineraryData;
            const output = itinerary.map(day => `${day.title} - ${day.summary}`).join('\n');
            document.getElementById('itinerary-output').textContent = `è¡Œç¨‹å®‰æ’ (${itinerary.length}å¤©):\n${output}`;
        }

        // äº‹ä»¶ç›‘å¬æ¼”ç¤º
        let eventLog = [];

        function simulateAPICall() {
            // æ¨¡æ‹Ÿä¸€ä¸ªå®Œæ•´çš„APIè°ƒç”¨æµç¨‹
            eventLog.push(`[${new Date().toLocaleTimeString()}] å¼€å§‹APIè°ƒç”¨`);

            setTimeout(() => {
                // æ¨¡æ‹Ÿç½‘ç»œå»¶è¿Ÿ
                TravelAPI.updateConfig({
                    title: 'æ¨¡æ‹ŸAPIæ›´æ–° - ' + Math.floor(Math.random() * 1000)
                });
                eventLog.push(`[${new Date().toLocaleTimeString()}] é…ç½®æ›´æ–°å®Œæˆ`);

                setTimeout(() => {
                    const newCard = {
                        id: 'api-card-' + Date.now(),
                        type: 'weather',
                        title: 'APIå¤©æ°”',
                        content: 'é€šè¿‡APIè·å–çš„å¤©æ°”ä¿¡æ¯',
                        value: Math.floor(Math.random() * 30) + 'Â°C',
                        status: 'available',
                        statusText: 'å®æ—¶',
                        icon: 'ğŸŒ¤ï¸',
                        pointTypes: ['all'],
                        pointId: null,
                        time: new Date().toLocaleTimeString('zh-CN', {hour: '2-digit', minute: '2-digit'})
                    };

                    const cards = [...window.CardsData, newCard];
                    TravelAPI.updateCards(cards);
                    eventLog.push(`[${new Date().toLocaleTimeString()}] å¡ç‰‡æ•°æ®æ›´æ–°å®Œæˆ`);

                    document.getElementById('events-output').textContent = eventLog.slice(-10).join('\n');
                }, 500);
            }, 1000);

            document.getElementById('events-output').textContent = eventLog.slice(-10).join('\n');
        }

        function batchUpdate() {
            eventLog.push(`[${new Date().toLocaleTimeString()}] å¼€å§‹æ‰¹é‡æ›´æ–°`);

            // åŒæ—¶æ›´æ–°å¤šä¸ªæ•°æ®æº
            Promise.all([
                TravelAPI.updateConfig({location: 'æ‰¹é‡æ›´æ–°æµ‹è¯•'}),
                TravelAPI.updateCards(window.CardsData.map(card => ({
                    ...card,
                    time: new Date().toLocaleTimeString('zh-CN', {hour: '2-digit', minute: '2-digit'})
                })))
            ]).then(() => {
                eventLog.push(`[${new Date().toLocaleTimeString()}] æ‰¹é‡æ›´æ–°å®Œæˆ`);
                document.getElementById('events-output').textContent = eventLog.slice(-10).join('\n');
            });
        }

        function showEventLog() {
            document.getElementById('events-output').textContent = `äº‹ä»¶æ—¥å¿— (æœ€è¿‘${eventLog.length}æ¡):\n` + eventLog.join('\n');
        }

        // ç›‘å¬æ‰€æœ‰æ•°æ®æ›´æ–°äº‹ä»¶
        DataEvents.on('configUpdated', (data) => {
            eventLog.push(`[${new Date().toLocaleTimeString()}] äº‹ä»¶: configUpdated`);
        });

        DataEvents.on('cardsUpdated', (data) => {
            eventLog.push(`[${new Date().toLocaleTimeString()}] äº‹ä»¶: cardsUpdated (${data.length}ä¸ªå¡ç‰‡)`);
        });

        DataEvents.on('routePointsUpdated', (data) => {
            eventLog.push(`[${new Date().toLocaleTimeString()}] äº‹ä»¶: routePointsUpdated (${data.length}ä¸ªç‚¹)`);
        });

        DataEvents.on('itineraryUpdated', (data) => {
            eventLog.push(`[${new Date().toLocaleTimeString()}] äº‹ä»¶: itineraryUpdated (${data.length}å¤©)`);
        });

        // åˆå§‹åŒ–æ˜¾ç¤º
        document.getElementById('config-output').textContent = 'ç‚¹å‡»æŒ‰é’®å¼€å§‹æ¼”ç¤ºé…ç½®ç®¡ç†åŠŸèƒ½';
        document.getElementById('route-output').textContent = 'ç‚¹å‡»æŒ‰é’®å¼€å§‹æ¼”ç¤ºè·¯çº¿ç‚¹ç®¡ç†åŠŸèƒ½';
        document.getElementById('cards-output').textContent = 'ç‚¹å‡»æŒ‰é’®å¼€å§‹æ¼”ç¤ºå¡ç‰‡ç®¡ç†åŠŸèƒ½';
        document.getElementById('itinerary-output').textContent = 'ç‚¹å‡»æŒ‰é’®å¼€å§‹æ¼”ç¤ºè¡Œç¨‹ç®¡ç†åŠŸèƒ½';
        document.getElementById('events-output').textContent = 'ç‚¹å‡»æŒ‰é’®å¼€å§‹æ¼”ç¤ºäº‹ä»¶ç›‘å¬åŠŸèƒ½';

        console.log('Mockæ•°æ®æ¼”ç¤ºé¡µé¢å·²åŠ è½½');
        console.log('å¯ä»¥é€šè¿‡æµè§ˆå™¨æ§åˆ¶å°ç›´æ¥è°ƒç”¨APIï¼š');
        console.log('- TravelAPI.updateConfig({title: "æ–°æ ‡é¢˜"})');
        console.log('- TravelAPI.addRoutePoint({x: 100, y: 100, name: "æµ‹è¯•ç‚¹", type: "attraction"})');
        console.log('- DataEvents.on("configUpdated", (data) => console.log("é…ç½®æ›´æ–°:", data))');
    </script>
</body>
</html>